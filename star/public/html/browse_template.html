<div class="browser" ng-init="search_in_folder=''">

	<div class="panel panel-{{current_inode.owner && 'default' || 'primary'}}">
		<div class="panel-heading clearfix" style="padding: 0">
			<div class="clearfix Xtext-ellipses" style="color: black; Xmax-width: 95%; Xpadding: 10px">
				<div class="btn-group">
					<button class="btn btn-link dropdown-toggle" data-toggle="dropdown" style="padding-right: 0">
						<i ng-show="!!current_inode.isdir" class="fa fa-folder-open fa-fw fa-lg"></i>
						<i ng-show="!current_inode.isdir" class="fa fa-file-o fa-fw fa-lg"></i>
					</button>
					<ul ng-if="has_parent(current_inode)" class="dropdown-menu" role="menu">
						<li ng-repeat="parent in nb.parents_path(current_inode)">
							<a ng-click="open_inode(parent)" style="padding-left: {{10+($index * 10)}}px">
								<i class="fa fa-folder-open-o fa-fw"></i>
								{{parent.name}}
							</a>
						</li>
					</ul>
				</div>
				<button class="btn btn-link btn-lg">
					{{current_inode.name}}
				</button>
				<span ng-if="current_inode.is_loading">
					<i class="fa fa-refresh fa-spin fa-fw"></i>
				</span>
				<span ng-if="false && !current_inode.owner" class="text-muted pull-right">
					<span style="margin-right: 20px">
						{{current_inode.ctime_display}}
					</span>
					<span ng-show="!current_inode.isdir" style="margin-right: 20px">
						{{human_size(current_inode.size)}}
					</span>
					<span>
						{{current_inode.owner.name}}
					</span>
				</span>
			</div>
			<button ng-if="has_parent(current_inode) || !current_inode.owner" class="btn btn-link" ng-click="go_up_level()" ng-disabled="!has_parent(current_inode)" title="Back to previous folder" rel="tooltip">
				<i class="fa fa-arrow-left fa-lg"></i>
			</button>
			<span ng-show="current_inode.owner">
				<button ng-if="current_inode.owner" class="btn btn-link" ng-click="copy_inode(current_inode)">
					<i class="fa fa-heart-o fa-fw"></i>
					Keep in My-Data
				</button>
				<a ng-if="!current_inode.isdir && !current_inode.uploading && current_inode.size" class="btn btn-link" ng-click="download_inode(current_inode)" href="{{nb.inode_api_url(current_inode.id)}}?is_download=true" target="_blank">
					<i class="fa fa-cloud-download fa-fw"></i>
					Download
				</a>
			</span>
			<span ng-show="!current_inode.owner">
				<button class="btn btn-link" ng-click="open_inode(current_inode)">
					<i class="fa fa-refresh fa-lg"></i>
					Refresh
				</button>
				<button class="btn btn-link" ng-click="new_folder(current_inode)">
					<i class="fa fa-plus fa-fw"></i>
					New Folder
				</button>
				<button class="btn btn-link" ng-click="nbUploadSrv.open_file_input()">
					<i class="fa fa-cloud-upload fa-lg"></i>
					Upload
				</button>
				<button class="btn btn-link" ng-if="!nb.is_immutable_root(current_inode)" ng-click="share_inode(current_inode)">
					<i class="fa fa-share-square-o fa-fw"></i>
					Share
				</button>
				<div class="input-group pull-right" style="max-width: 170px">
					<input type="text" class="form-control {{search_in_folder && 'bg-yellow' || ''}}" maxlength="100" placeholder="Search in folder" ng-model="search_in_folder" />
					<span class="input-group-btn">
						<button class="btn btn-default" type="button" ng-click="search_in_folder=''" title="Clear search" rel="tooltip" nb-tooltip="{container: 'body'}">
							<i class="fa fa-times Xfa-lg"></i>
						</button>
					</span>
				</div>
			</span>
		</div>

		<div class="panel-body" style="padding: 0">
			<div ng-repeat="inode in current_inode.entries | filter:{name: search_in_folder}" class="file_line notextselect {{inode.is_selected && 'active' || ''}}" style="border-bottom-width: 1px; border-top-width: 1px">
				<div class="clearfix" style="overflow: scroll" ng-click="select_inode(inode, $index, $event)">
					<span>
						<i ng-show="!!inode.isdir" class="fa fa-folder-open fa-fw fa-lg text-danger"></i>
						<i ng-show="!inode.isdir" class="fa fa-file-o fa-fw fa-lg text-danger"></i>
						<a class="btn btn-link" ng-click="open_inode(inode, $index, $event)" style="padding-left: 0; display: inline">
							{{inode.name}}
						</a>
					</span>
					<span ng-if="!current_inode.owner" class="text-muted pull-right">
						<span ng-show="!inode.isdir" style="margin-right: 20px">
							{{human_size(inode.size)}}
						</span>
						<span>
							{{inode.ctime_display}}
						</span>
					</span>
				</div>
				<div ng-if="is_selection_leader(inode)" class="file_actions">
					<div Xclass="text-right">
						<span ng-if="num_selected()>1">
							&nbsp;&nbsp;{{num_selected()}} items:
						</span>
						<button ng-if="!current_inode.owner && num_selected()==1" class="btn btn-link" ng-click="share_inode(inode)">
							<i class="fa fa-share-square-o fa-fw"></i>
							Share
						</button>
						<button ng-if="current_inode.owner && num_selected()==1" class="btn btn-link" ng-click="copy_inode(inode)">
							<i class="fa fa-heart-o fa-fw"></i>
							Keep in My-Data
						</button>
						<a ng-if="!inode.isdir && !inode.uploading && inode.size && num_selected()==1" class="btn btn-link" ng-click="download_inode(inode)" href="{{nb.inode_api_url(inode.id)}}?is_download=true" target="_blank">
							<i class="fa fa-cloud-download fa-fw"></i>
							Download
						</a>
						<button ng-if="!inode.is_previewing && !inode.isdir && num_selected()==1" class="btn btn-link" ng-click="toggle_preview(inode)">
							<i class="fa fa-search-plus fa-fw"></i>
							Show Preview
						</button>
						<button ng-if="inode.is_previewing && !inode.isdir && num_selected()==1" class="btn btn-link" ng-click="toggle_preview(inode)">
							<i class="fa fa-search-minus fa-fw"></i>
							Hide Preview
						</button>
						<button ng-if="!current_inode.owner && num_selected()==1" class="btn btn-link" ng-click="rename_inode(inode)">
							<i class="fa fa-pencil fa-rotate-270 fa-fw"></i>
							Rename
						</button>
						<button ng-if="false && !current_inode.owner && num_selected()==1" class="btn btn-link" ng-click="copy_inode(inode)">
							<i class="fa fa-copy fa-fw"></i>
							Copy {{num_selected()>1 && 'all' || ''}}
						</button>
						<button ng-if="false && !current_inode.owner" class="btn btn-link" ng-click="move_inodes()">
							<i class="fa fa-arrows fa-fw"></i>
							Move {{num_selected()>1 && 'all' || ''}}
						</button>
						<button ng-if="!current_inode.owner" class="btn btn-link" ng-click="delete_inodes()">
							<i class="fa fa-trash-o fa-fw"></i>
							Delete {{num_selected()>1 && 'all' || ''}}
						</button>
					</div>
					<div ng-if="inode.is_previewing && inode.is_selected && inode.content_kind" ng-switch="inode.content_kind" style="padding: 10px 0">
						<video ng-switch-when="video" controls ng-src="{{nb.inode_api_url(inode.id)}}" class="img-responsive center-block"></video>
						<audio ng-switch-when="audio" controls ng-src="{{nb.inode_api_url(inode.id)}}" class="img-responsive center-block"></audio>
						<img ng-switch-when="image" ng-src="{{nb.inode_api_url(inode.id)}}" class="img-responsive center-block" style="max-height: 60%" />
						<div ng-switch-default nb-resizable>
							<object ng-attr-data="{{nb.inode_api_url(inode.id)}}" ng-attr-type="{{inode.content_type}}" width="100%" height="100%" class="center-block"></object>
						</div>
					</div>
					<div ng-if="inode.is_previewing && inode.is_selected && !inode.content_kind" class="text-center" style="padding: 10px 0">
						<i class="fa fa-spinner fa-spin fa-2x"></i>
					</div>
				</div>
			</div>
			<div ng-if="current_inode.isdir && !current_inode.entries.length">
				<div style="padding-left: 20px; line-height: 80px; vertical-align: middle">
					- No files yet -
				</div>
			</div>
		</div>
	</div>
</div>
