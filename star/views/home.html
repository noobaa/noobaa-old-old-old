<!DOCTYPE html>
<html ng-app="noobaa_app" xmlns:fb="http://ogp.me/ns/fb#" lang="en">

<head>
	<?# def.include( 'common_head.html') ?>
		<base href="/home/">
</head>

<body ng-cloak ng-controller="HomeCtrl">

	<?# def.include( 'common_menubar.html') ?>

		<div Xstyle="position: relative">
			<div ng-view Xclass="view-animate"></div>
		</div>



		<div class="container">

			<!-- TOOLBAR -->


			<div class="row" style="margin-bottom: 20px;" hidden>

				<div class="col-md-3 text-center">
					<div class="btn-group" style="width: 100%">
						<button id="space_button" class="btn btn-danger radius_right" style="width: 50%; border: solid 1px rgba(0,0,0,0.4);" ng-click="open_local_planet()" title="Add Space">
							<i class="icon-rocket icon-large"></i>
						</button>
						<button id="upload_button" class="btn btn-success radius_left" style="width: 50%; border: solid 1px rgba(0,0,0,0.4);" ng-click="toggle_uploads_view()" title="Upload" ng-disabled="!dir_selection.inode">
							<i class="icon-cloud-upload icon-large"></i>
						</button>
					</div>
				</div>

				<div class="col-md-6">
					<button class="btn btn-default toolbtn" id="open_button" ng-click="click_open()" title="Open" ng-disabled="!inode_selection.inode">
						<i class="icon-play icon-large"></i>
					</button>
					<button class="btn btn-default toolbtn" id="share_button" ng-click="click_share()" title="Share" ng-disabled="!inode_selection.inode">
						<i class="icon-share icon-large"></i>
					</button>
					<button class="btn btn-default toolbtn" ng-click="click_refresh()" title="Refresh" ng-disabled="!dir_selection.inode">
						<i class="icon-refresh icon-large"></i>
					</button>
					<div class="dropdown btn-group" align="left">
						<button class="dropdown-toggle btn btn-default toolbtn" id="more_actions_label" role="button" data-toggle="dropdown" data-target="#" ng-disabled="!inode_selection.inode">
							More
							<i class="caret"></i>
						</button>
						<ul class="dropdown-menu pull-right" role="menu" aria-labelledby="more_actions_label">
							<li>
								<a href="#" ng-click="click_mkdir()">
									<i class="icon-plus icon-large icon-fixed-width"></i>
									New Folder
								</a>
							</li>
							<li>
								<a href="#" ng-click="click_rename()">
									<i class="icon-edit icon-large icon-fixed-width"></i>
									Rename
								</a>
							</li>
							<li>
								<a href="#" ng-click="click_copy()">
									<i class="icon-copy icon-large icon-fixed-width"></i>
									Copy
								</a>
							</li>
							<li class="divider"></li>
							<li>
								<a href="#" ng-click="click_delete()">
									<i class="icon-trash icon-large icon-fixed-width"></i>
									Delete
								</a>
							</li>
						</ul>
					</div>
				</div>

				<div class="col-md-3 input-group">
					<input type="text" class="form-control input-sm" maxlength="100" placeholder="filter files by name" ng-model="filter_file_name" ng-style="{backgroundColor: filter_file_name && 'pink' || 'none'}" />
					<span class="input-group-btn">
						<button class="btn btn-default btn-sm" type="button" ng-click="filter_file_name=''">
							<i class="icon-remove-sign icon-large"></i>
						</button>
					</span>
				</div>

			</div>


			<!-- CONTEXT MENU -->

			<div id="context_menu" class="dropdown" style="z-index: 100;">
				<a id="context_menu_toggle" class="dropdown-toggle" data-toggle="dropdown" href="#" hidden="true">
				</a>
				<ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
					<li>
						<a href="#" ng-click="click_open()">
							<i class="icon-play icon-fixed-width"></i>
							Open
						</a>
					</li>
					<li>
						<a href="#" ng-click="click_download()">
							<i class="icon-cloud-download icon-fixed-width"></i>
							Download
						</a>
					</li>
					<li>
						<a href="#" ng-click="click_share()">
							<i class="icon-share icon-fixed-width"></i>
							Share
						</a>
					</li>
					<li>
						<a href="#" ng-click="click_refresh()">
							<i class="icon-refresh icon-fixed-width"></i>
							Refresh
						</a>
					</li>
					<li class="divider"></li>
					<li>
						<a href="#" ng-click="click_mkdir()">
							<i class="icon-plus icon-fixed-width"></i>
							New folder
						</a>
					</li>
					<li>
						<a href="#" ng-click="click_rename()">
							<i class="icon-edit icon-fixed-width"></i>
							Rename
						</a>
					</li>
					<li>
						<a href="#" ng-click="click_copy()">
							<i class="icon-copy icon-fixed-width"></i>
							Copy
						</a>
					</li>
					<li class="divider"></li>
					<li>
						<a href="#" ng-click="click_delete()">
							<i class="icon-trash icon-fixed-width"></i>
							Delete
						</a>
					</li>
				</ul>
			</div>


			<!-- PLANET DOWNLOADS VIEW -->



			<!-- UPLOADS VIEW -->



			<!-- VIEWS -->


			<!-- 
	<div class="notextselect row"
		style="min-height: 400px">
		<div class="col-md-3" style="margin-bottom: 20px">
			<div ng-controller="InodesTreeCtrl"
				ng-include="'tree_view_template.html'"
		 		nb-right-click="inode_rclick(dir_selection.inode, $event)"
				class="roundbord bglight"
				style="min-height: 200px"
				id="inodes_tree">
			</div>
		</div>
		<div class="col-md-9" style="margin-bottom: 20px">
			<div ng-controller="InodesListCtrl"
				ng-include="'list_view_template.html'"
				nb-key="key_handler($event)" tabindex="1"
		 		nb-right-click="inode_rclick(dir_selection.inode, $event)"
				class="roundbord bglight"
				style="min-height: 400px; outline: none"
				id="inodes_list"
				nb-drop="dir_selection.inode">
			</div>
		</div>
	</div>

 -->



			<!-- SHARE MODAL -->

			<div ng-controller="ShareModalCtrl" id="share_modal" class="nbdialog fntmd" tabindex="-1" role="dialog" aria-labelledby="share_modal_label" aria-hidden="true">
				<div class="nbdialog_header nbdialog_drag">
					Share
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<div ng-show="share_is_loading" class="text-center" style="padding: 30px">
						<i class="icon-spinner icon-spin icon-2x"></i>
					</div>
					<div ng-show="!share_is_loading && !share_list.length">
						<p>No friends are availabe for sharing.</p>
						<p>Currenlty sharing is only availalbe for NooBaa users who are your social network friends.</p>
						<p>Invite your friends to NooBaa today.</p>
					</div>
					<div ng-show="!share_is_loading && share_list.length" ng-init="filter_friend_name=''">
						<p>
							Share this item with friends:
							<div class="inode_label"></div>
						</p>
						<form role="form">
							<div class="input-group">
								<input type="text" class="form-control input-sm" placeholder="Search in friends" ng-model="filter_friend_name" />
								<span class="input-group-btn">
									<button class="btn btn-default btn-sm" type="button" ng-click="filter_friend_name=''">
										<i class="icon-remove-sign icon-large"></i>
									</button>
								</span>
							</div>
						</form>
						<table class="table">
							<tr ng-repeat="friend in share_list | filter:{name: filter_friend_name} | orderBy:'name'" ng-class="{true: 'danger'}[friend.shared]" ng-click="friend.shared = !friend.shared">
								<td>
									<img ng-src="{{ nb.user_pic_url(friend) }}"></img>
								</td>
								<td>{{friend.name}}</td>
								<td>
									<i ng-show="friend.shared" class="icon-check icon-large icon-fixed-width"></i>
									<i ng-hide="friend.shared" class="icon-check-empty icon-large icon-fixed-width"></i>
								</td>
							</tr>
						</table>
					</div>
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Cancel</button>
					<div class="pull-right">
						<div class="btn-group dropup">
							<button type="button" class="btn btn-default" ng-click="mklink()">
								Get Link
							</button>
							<button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
								<span class="caret"></span>
							</button>
							<ul class="dropdown-menu pull-right" role="menu">
								<li>
									<a href="#" ng-click="rmlinks()">
								Revoke Previous Links !
							</a>
								</li>
							</ul>
						</div>
						<button class="btn btn-primary" ng-click="submit()">Save</button>
					</div>
				</div>
			</div>

			<!-- GET LINK DIALOG -->

			<div id="getlink_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					File Link
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<p>Copy &amp; Paste this file link to send or post anywhere you want:</p>
					<div class="inode_label"></div>
					<div class="link_label"></div>
				</div>
				<div class="nbdialog_footer text-center">
					<button class="nbdialog_close btn btn-default">Close</button>
				</div>
			</div>


			<!-- FILE/DIR WITH ICON -->

			<div id="inode_with_icon">
				<i id="inode_with_icon_dir" class="icon-folder-close icon-large d-icon" style="display: none"></i>
				<i id="inode_with_icon_file" class="icon-file icon-large d-icon" style="display: none; color: grey"></i>
				<span id="inode_with_icon_name" class="fntmd fntthin"></span>
			</div>

			<!-- MOVE DIALOG -->

			<div id="move_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					Confirm Move
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<p>Are you sure you want to move?</p>
					<div class="inode_label"></div>
					<p>into this folder:</p>
					<div class="inode_label"></div>
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Cancel</button>
					<button id="dialog_ok" class="btn btn-primary pull-right">Move</button>
				</div>
			</div>

			<!-- DELETE DIALOG -->

			<div id="delete_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					Confirm Delete
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<p id="not_empty_msg" style="display: none">
						The selected folders are not empty.
						<br/>Are you sure you want to delete all its content?
					</p>
					<p id="normal_msg">Are you sure you want to delete the selected items?</p>
					<div class="inode_label"></div>
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Cancel</button>
					<button id="dialog_ok" class="btn btn-danger pull-right">Delete</button>
				</div>
			</div>

			<!-- COPY DIALOG -->

			<div id="copy_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					Files copied to "My Data"
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="OK">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Ok</button>
				</div>
			</div>

			<!-- MKDIR DIALOG -->

			<div id="mkdir_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					New Folder...
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<p>
						Create new folder under:
						<div class="inode_label"></div>
					</p>
					<input id="dialog_input" class="form-control" type="text" />
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Cancel</button>
					<button id="dialog_ok" class="btn btn-primary pull-right">Create</button>
				</div>
			</div>

			<!-- RENAME DIALOG -->

			<div id="rename_dialog" class="nbdialog fntmd">
				<div class="nbdialog_header nbdialog_drag">
					Rename...
					<a class="pull-right nbdialog_close btn btn-default btn-xs" title="Cancel">
						<i class="icon-remove"></i>
					</a>
				</div>
				<div class="nbdialog_content">
					<p>
						New name for:
						<div class="inode_label"></div>
					</p>
					<input id="dialog_input" class="form-control" type="text" />
				</div>
				<div class="nbdialog_footer">
					<button class="nbdialog_close btn btn-default">Cancel</button>
					<button id="dialog_ok" class="btn btn-primary pull-right">Rename</button>
				</div>
			</div>



			<!-- ======== END MyDataCtrl ======== -->
		</div>




		<!-- TREE TEMPLATE -->

		<script type="text/ng-template" id="tree_view_template.html">
		< div > < div class = "d-row d-head btn-info fnt fntmd fntwht" > < div class = "d-cell"
		style = "margin-left: 35px" > Folders Tree < /div>
		</div > < div class = "fntthin"
		ng - include = "'tree_item_template.html'" > < /div>
	</div >
		</script>

		<!-- recursive html template to be loaded and compiled by angular per item -->
		<script type="text/ng-template" id="tree_item_template.html">
		< div ng - repeat = "dir_inode in dir_inode.dir_state.subdirs_list" > < div class = "d-row a-row text-ellipses nbdrag ng-class: dir_inode.dir_active;"
		title - on - ellipsis = "{{dir_inode.name}}"
		ng - click = "inode_click(dir_inode)"
		nb - right - click = "inode_rclick(dir_inode, $event)"
		ng - dblclick = "inode_dclick(dir_inode)"
		nb - drag = "dir_inode"
		nb - drop = "dir_inode" > < div style = "display: inline-block; width: {{20*(dir_inode.level-1)}}px" > < /div>
			<span class="d-cell"
				ng-click="inode_dclick(dir_inode)">
				<i class="icon-refresh icon-large icon-fixed-width
						ng-class: dir_inode.icon_class||'d-icon'"
					ng-show="!!dir_inode.dir_state.refreshing"></i > < span class = "icon-stack"
		style = "font-size: 11px"
		ng - show = "!dir_inode.dir_state.refreshing
						&& !dir_inode.dir_state.expanded" > < i class = "icon-folder-close icon-stack-base icon-fixed-width
						ng-class: dir_inode.icon_class||'d-icon'" > < /i>
					<i class="icon-plus icon-light icon-fixed-width"
						style="font-size: 8px"></i > < /span>
				<i class="icon-folder-open icon-large icon-fixed-width
						ng-class: dir_inode.icon_class||'d-icon'"
					ng-show="!dir_inode.dir_state.refreshing
						&& dir_inode.dir_state.expanded"></i > < /span>
			<span class="d-cell ng-class: dir_inode.caption_class">
				{{dir_inode.name}}
			</span > < /div>
		<div ng-include="'tree_item_template.html'"
			nb-effect-toggle="dir_inode.dir_state.expanded && dir_inode.dir_state.populated"
		 	nb-effect-options="{effect:'blind', duration:150}">
		</div > < /div>
		</script>



		<!-- LIST TEMPLATE -->

		<script type="text/ng-template" id="list_view_template.html">
		< div class = "t-table" >

		 < div class = "t-icon-column" > < /div>
		<div class="t-name-column"></div > < div class = "t-size-column" > < /div>
		<div class="t-shared-column"></div > < div class = "t-ctime-column" > < /div>

		<div class="t-row d-row d-head btn-info fnt fntmd fntwht">
			<div class="t-cell"></div > < div class = "t-cell" > < a style = "color: white"
		ng - click = "toggle_sort_by_name()"
		href = "#" >
			Name < i ng - class = "get_sort_by_name_class()" > < /i>
				</a > < /div>
			<div class="t-cell">
				<a style="color: white" ng-click="toggle_sort_by_size()" href="#">
					Size
					<i ng-class="get_sort_by_size_class()"></i > < /a>
			</div > < div class = "t-cell text-center" > < a style = "color: white"
		ng - click = "toggle_sort_by_shared()"
		href = "#" > < span ng - show = "dir_selection.inode.swm" > Shared By < /span>
					<span ng-hide="dir_selection.inode.swm">Sharing</span > < i ng - class = "get_sort_by_shared_class()" > < /i>
				</a > < /div>
			<div class="t-cell text-center">
				<a style="color: white" ng-click="toggle_sort_by_ctime()" href="#">
					<span ng-show="dir_selection.inode.swm">On</span > < span ng - hide = "dir_selection.inode.swm" > Created < /span>
					<i ng-class="get_sort_by_ctime_class()"></i > < /a>
			</div > < /div>

		<div ng-repeat="inode in dir_selection.inode.dir_state.sons_list | filter:{name: filter_file_name}"
			class="t-row-group a-row nbdrag fntthin ng-class: inode.inode_active;"
			ng-click="inode_click(inode)"
			ng-dblclick="inode_dclick(inode)"
			nb-right-click="inode_rclick(inode, $event)"
			nb-drop="{true:inode}[inode.isdir]"
			nb-drag="inode">
			<div class="t-row d-row">
				<div class="t-cell text-center">
					<i ng-show="inode.isdir" class="icon-folder-close icon-large d-icon"></i > < i ng - hide = "inode.isdir"
		class = "icon-file icon-large d-icon"
		style = "color: grey" > < /i>
				</div > < div class = "t-cell" > {
			{
				inode.name
			}
		} < /div>
				<div class="t-cell">
					<span ng-show="inode.uploading" title="Incomplete upload - Click to resume"
						ng-click="inode_upload(inode)">
						<i class="icon-cloud-upload icon-fixed-width"></i > < /span>
					<span ng-hide="inode.isdir">
						{{human_size(inode.size)}}
					</span > < /div>
				<div class="t-cell text-center">
					<span ng-show="inode.owner">
						{{inode.owner.name}}</span > < i ng - show = "!!inode.num_refs"
		class = "icon-share icon-large d-icon"
		title = "Shared with {{inode.num_refs}} friends"
		ng - click = "click_share(inode)" > < /i>
					<img ng-show="!!inode.owner"
						class="pull-right"
						ng-src="{{get_pic_url(inode.owner)}}" 
						style="width: 30px; height: 30px;"></img > < /div>
				<div class="t-cell  text-center">
					<span ng-show="inode.ctime">
						{{inode.ctime_display}}
					</span > < /div>
			</div >
		 <!-- div class="t-row"
		ng - show = "inode.inode_active"
		style = "height: 100px" > < div class = "t-cell text-center" > < /div>
				<div class="t-cell">TODO: More details...</div > < div class = "t-cell" > < /div>
				<div class="t-cell"></div > < /div -->
		</div >

		 < /div>
		</script>



		<!-- PATH TEMPLATE -->

		<script type="text/ng-template" id="path_view_template.html">
		< ul class = "inline"
		style = "margin: 4px" > < li ng - repeat = "inode in dir_selection.inode.get_path()"
		ng - class = "inode.dir_active" > < span ng - show = "inode.dir_active" > < b > {
			{
				inode.name || "@"
			}
		} < /b>
			</span > < a ng - hide = "inode.dir_active"
		ng - click = "inode_click(inode)"
		href = "#" > < b > {
			{
				inode.name || "@"
			}
		} < /b>
			</a > < span ng - hide = "inode.dir_active"
		class = "divider" > /</span > < /li>
	</ul >
		</script>



		<?# def.include( 'common_scripts.html') ?>

			<script src="/vendor/bootstrap-tour/js/bootstrap-tour.js" type="text/javascript"></script>
			<script src="/vendor/async/lib/async.js" type="text/javascript"></script>
			<script src="/vendor/bootstrap-growl/jquery.bootstrap-growl.min.js" type="text/javascript"></script>
			<!-- <script src="/public/js/menu_ctrl.js" type="text/javascript"></script> -->
			<!-- <script src="/public/js/guide_ctrl.js" type="text/javascript"></script> -->
			<script src="/public/js/upload_srv.js" type="text/javascript"></script>
			<script src="/public/js/home_ng.js" type="text/javascript"></script>
			<!-- <script src="/public/js/planet/planet_ctrl.js" type="text/javascript"></script> -->
			<!-- <div ng-controller="PlanetCtrl"></div> -->

</body>

</html>
