<!DOCTYPE html>
<html ng-app="noobaa_app" xmlns:fb="http://ogp.me/ns/fb#" lang="en">

<head>
	<?# def.include('common_head.html') ?>
</head>

<body class="bglight">
	<?# def.facebook_init_body ?>

	<div class="nb_page_pad">
		<table class="table">
			<thead>
				<th>Name</th>
				<th>Alpha</th>
				<th>Custom Email</th>
			</thead>
			<tbody>
			<? for (var user_id in it.users) { var user = it.users[user_id]; ?>
				<tr>
					<td><?!user.fb.name?></td>
					<td><?!user.alpha_tester?></td>
					<td><?!user.email?></td>
				</tr>

				<? if (user.devices) { ?>
				<tr>
					<td colspan="100">
						<table class="table table-condensed pull-right"
							style="width: 90%">
							<thead>
								<th>Device</th>
								<th>Info</th>
								<th>Last Update</th>
								<th>#Updates</th>
							</thead>
							<tbody>
								<? for (var dev_id in user.devices) { var dev = user.devices[dev_id]; ?>
								<tr>
									<td><?!dev.name?></td>
									<td><?! JSON.stringify(dev.host_info)?></td>
									<td><?!dev.last_update.toLocaleString() ?> </td>
									<td><?!dev.total_updates?> </td>
								</tr>
								<? } ?>
							</tbody>
						</table>
					</td>
				</tr>
				<? } ?>

			<? } ?>
			</tbody>
		</table>
	</div>

	<?# def.include('common_scripts.html') ?>

	<script type="text/javascript">
		function AdminoobaaCtrl($scope) {
			// TODO: switch to use angular instead of server side template
			// $scope.users
		}
	</script>

</body>

</html>