<!DOCTYPE html>
<html ng-app="nb_home" xmlns:fb="http://ogp.me/ns/fb#" lang="en">

<head>
    <?# def.include( 'common_head.html') ?>
        <base href="/home/">
</head>

<body ng-cloak ng-controller="HomeCtrl">

    <div>
        <?# def.facebook_init_body ?>
    </div>

    <div class="table-layout">

        <div class="table-row">
            <div ng-include="'home_navbar.html'"></div>
            <div style="height: 30px"></div>
        </div>

        <div ng-show="nbUploadSrv.has_uploads()" class="table-row fadeIn">
            <div ng-include="'upload_template.html'"></div>
        </div>

        <div class="table-row table-row-expand">
            <div class="container hfill">
                <div ng-view class="hfill"></div>
            </div>
        </div>


        <div class="table-foot">
            <div style="height: 30px"></div>
            <div ng-include="'site_foot_template.html'"></div>
        </div>

    </div>


    <!-- INSTALL  -->

    <div style="display: none" ng-non-bindable>
        <div id="client_installation">
            <div style="padding: 10px">
                <p class="text-left">
                    Experience with the NooBaa client:
                    <ul class="fa-ul">
                        <li><i class="fa fa-li fa-rocket"></i>
                            Expand your account space as much as you want!</li>
                        <li><i class="fa fa-li fa-refresh"></i>
                            Automatic resume of uploads (even on disconnection or reboot)</li>
                        <li><i class="fa fa-li fa-folder-open"></i>
                            Upload / Download entire folders</li>
                    </ul>
                </p>
                <div class="text-center">
                    <a class="btn btn-link" href="https://noobaa-download.s3.amazonaws.com/noobaa-windows-setup-0.1.exe">
                        <img src="/public/images/windows_logo.png" style="margin: 5px; width: 60px; height: 60px"></img>
                        <div>Download for Windows</div>
                    </a>
                    <a class="btn btn-link" href="https://noobaa-download.s3.amazonaws.com/noobaa-osx-0.1.zip" style="border-radius: 0; margin: 0">
                        <img src="/public/images/mac_logo_small.png" style="margin: 5px; width: 60px; height: 60px"></img>
                        <div>Download for Mac</div>
                    </a>
                    <a class="btn btn-link" href="https://noobaa-download.s3.amazonaws.com/noobaa-linux-0.1.tar.gz">
                        <img src="/public/images/linux_logo.png" style="margin: 5px; width: 60px; height: 60px"></img>
                        <div>Download for Linux</div>
                    </a>
                </div>
            </div>
        </div>
    </div>



    <!-- EXPAND -->

    <div style="display: none" ng-non-bindable>
        <div id="client_expansion">
            <div class="text-center" style="padding: 10px">
                <span ng-repeat="plan in nbPlanet.coshare_options">
                    <button href="#" class="btn btn-lg Xbtn-block" ng-click="nbPlanet.select_coshare_option($index)" ng-class="nbPlanet.coshare_options_class($index)">
                        {{plan.title}}
                    </button>
                </span>
            </div>
            <button ng-if="false" class="btn btn-link btn-block" ng-click="nbUtil.coming_soon()" Xonclick="$('#coshare_path').trigger('click')">
                Advanced...
            </button>
            <input id="coshare_path" style="display: none" type="file" name="file" nwdirectory>
            </input>
        </div>
    </div>



    <!-- PLAY -->

    <div style="display: none" ng-non-bindable>
        <div id="play_dialog">
            <div class="modal-body clearfix" style="padding: 20px; max-height: 100%; background-color: hsl(0,0%,15%); color: hsl(0,0%,90%)">
                <div class="row">
                    <div class="col-sm-9 text-left" style="min-height: 200px; border-right: 1px solid hsl(0,0%,30%)">
                        <div nb-media="selected.item" nb-subtitles="selected.subtitles" show-content="true" media-events="media_events" style="Xdisplay: inline-block; width: auto; max-height: 100%"></div>
                    </div>
                    <div class="col-sm-3 clearfix">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                            <span class="text-white">&times;</span>
                        </button>
                        <h4 class="text-center text-wrap">{{name}}</h4>
                        <div ng-if="items" style="padding-top: 15px">
                            <b>Playing track:</b>
                            <select ng-model="selected.item" ng-options="x.name group by x.content_kind for x in items" class="form-control"></select>
                        </div>
                        <div ng-if="subtitles" style="padding-top: 15px">
                            <b>Subtitle track:</b>
                            <select ng-model="selected.subtitles" ng-options="x.name for x in subtitles" class="form-control"></select>
                        </div>
                        <!-- <div class="text-center" style="padding: 20px"> -->
                        <!-- <button class="btn btn-primary btn-lg" data-dismiss="modal">Close</button> -->
                        <!-- </div> -->
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- SHARE MODAL -->

    <div style="display: none" ng-non-bindable>
        <div id="share_modal" style="max-height: 100%" ng-init="filter_friend_name=''">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h4>Invite friends to {{share_inode.name}}</h4>
            </div>
            <div class="modal-body" style="padding: 0">
                <div style="max-height: 100%">
                    <div style="padding: 10px 20px">
                        <div>Comments:</div>
                        <div style="margin: 5px 0">
                            <div ng-repeat="msg in share_inode.messages" class="clearfix hover-target" style="margin-bottom: 5px">
                                <img class="img-circle pull-left" ng-src="{{nbUser.user_pic_url(msg.user)}}" style="width: 32px; height: 32px; margin-right: 5px; vertical-align: top" />
                                <div style="overflow: hidden">
                                    <div>
                                        <small class="text-primary"><b>{{msg.user.first_name}}</b>
                                        </small>
                                        &nbsp;
                                        <small>
                                            <span style="white-space: pre-wrap" ng-bind-html="msg.text | linky:'_blank'"></span>
                                        </small>
                                    </div>
                                    <div>
                                        <small class="text-muted">
                                            {{moment(msg.create_time).fromNow()}}
                                            <a ng-click="delete_inode_message(share_inode, msg)" class="visible-hover-only">
                                                <i class="fa fa-times fa-fw text-muted"></i>
                                            </a>
                                        </small>
                                    </div>
                                </div>
                            </div>
                            <div ng-show="comments_loading" class="text-center" style="padding: 10px">
                                <i class="fa fa-refresh fa-spin fa-lg"></i>
                            </div>
                            <div>
                                <textarea ng-model="share_text" rows="2" class="form-control" placeholder="Write about it..." nb-focus="!share_list_loading"></textarea>
                                <div></div>
                            </div>
                        </div>
                    </div>
                    <div ng-if="!share_list_loading && shr=='r'">
                        <hr style="margin: 0" />
                        <div class="center-block" style="width: 160px; padding: 0 20px 10px 20px">
                            <div class="Xinput-group input-group-sm" style="position: relative">
                                <input type="text" class="form-control bottom-radius {{filter_friend_name && 'label-primary'}}" placeholder="Search friends" ng-model="filter_friend_name" />
                                <i ng-show="filter_friend_name" class="fa fa-times fa-fw" style="cursor: pointer; position: absolute; right: 8px; top: 8px" ng-click="filter_friend_name=''"></i>
                            </div>
                        </div>
                        <div style="padding: 0 20px 10px 20px; max-height: 300px; overflow-y: scroll; overflow-x: hidden">
                            <div ng-repeat="friend in share_list | filter:{name: filter_friend_name} | orderBy:'name'" class="text-ellipses {{friend.shared && 'label-warning'}}" style="display: inline-block; Xborder-radius: 20px; width: 260px; margin: 0 2px; padding: 5px 10px; cursor: pointer; text-align: left" ng-click="friend.shared = !friend.shared">
                                <i class="fa fa-{{friend.shared && 'check' || 'plus-square'}} fa-fw"></i>&nbsp;
                                <img width="32" height="32" ng-src="{{nbUser.user_pic_url(friend)}}" class="img-circle" />&nbsp;
                                <span>{{friend.name}}</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer" style="margin-top: 0">
                <span ng-if="share_list_loading" class="text-center" style="padding: 20px">
                    <i class="fa fa-refresh fa-spin fa-lg"></i>
                </span>
                <div class="btn-group dropdown dropdown-hover">
                    <button class="btn btn-link dropdown-toggle" type="button" data-toggle="dropdown">
                        <span ng-if="shr == 'f'">
                            <i class="fa fa-users fa-fw"></i>
                            All Friends
                        </span>
                        <span ng-if="shr == 'r'">
                            <i class="fa fa-cog fa-fw"></i>
                            Choose Friends
                        </span>
                        <i class="fa fa-caret-down"></i>
                    </button>
                    <ul class="dropdown-menu transition-fast text-left" role="menu">
                        <li>
                            <a ng-click="shr = 'f'">
                                <i class="fa fa-{{(shr=='f') && 'check'}} fa-fw"></i>
                                <i class="fa fa-users fa-fw"></i>
                                All Friends
                            </a>
                        </li>
                        <li>
                            <a ng-click="set_shr_refs()">
                                <i class="fa fa-{{(shr=='r') && 'check'}} fa-fw"></i>
                                <i class="fa fa-cog fa-fw"></i>
                                Choose Friends
                            </a>
                        </li>
                    </ul>
                </div>
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-primary" ng-click="run()" ng-disabled="share_list_loading">Update</button>
            </div>
        </div>
    </div>



    <div>
        <?# def.include( 'common_scripts.html') ?>
    </div>

</body>

</html>
